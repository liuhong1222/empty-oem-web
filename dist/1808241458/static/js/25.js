webpackJsonp([25],{"3Big":function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var r=t("a3Yh"),o=t.n(r),l=t("KPSb"),i=t.n(l),s=t("E4LH"),n=t("A+mb"),d={data:function(){return{agentReadonly:!1,priseimageUrl:"",priseurl:"",licensePicNo:"",visible:!1,labelPosition:"right",agencylevelArr:[],dataForm:{id:0,businNumber:"",companyName:"",bussicAdress:"",lawName:"",businNum:"",busindate1:"",busindate2:"",username:"",mobile:"",email:"",work:"",loginAcc:"",pwd:"",agencylevel:"",price:"",allowCounts:""},datarules:{businNumber:[{required:!0,message:"请输入最长为6的商家编号（只能为数字）",trigger:"blur"}],companyName:[{required:!0,message:"请输入公司名称",trigger:"blur"}],bussicAdress:[{required:!0,message:"请输入营业执照所在地",trigger:"blur"}],lawName:[{required:!0,message:"请输入法人姓名",trigger:"blur"}],businNum:[{required:!0,message:"请输入营业执照号",trigger:"blur"}],busindate1:[{required:!0,message:"请输入营业期限",trigger:"blur"}],username:[{required:!0,message:"请输入联系人姓名",trigger:"blur"}],mobile:[{required:!0,message:"请输入联系电话",trigger:"blur"},{validator:function(e,a,t){Object(s.b)(a)?t():t(new Error("手机号格式错误"))},trigger:"blur"}],loginAcc:[{required:!0,message:"请输入登录账号",trigger:"blur"}],pwd:[{required:!0,message:"请输入初始密码",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"}],work:[{required:!0,message:"请输入职务",trigger:"blur"}],price:[{required:!0,message:"请输入单价",trigger:"blur"}],allowCounts:[{required:!0,message:"请输入允许超出条数",trigger:"blur"}]}}},watch:{dataForm:{handler:function(e,a){this.dataForm.loginAcc=this.dataForm.mobile},deep:!0}},methods:{showInit:function(e){var a=this;this.dataForm.id=e||0,this.visible=!0,this.$http({url:this.$http.adornUrl("agent/level/list?token="+this.$cookie.get("token")),method:"get"}).then(function(e){var t=e.data;t&&0===t.code?a.agencylevelArr=t.data:a.agencylevelArr=[]}),this.$nextTick(function(){a.$refs.dataForm.resetFields()}),this.priseurl=this.$http.adornUrl("agent/agentInfo/license/upload?token="+this.$cookie.get("token")),this.dataForm.id&&(this.agentReadonly=!0,this.$http({url:this.$http.adornUrl("agent/agentInfo/detail?token="+this.$cookie.get("token")+"&agentId="+this.dataForm.id),method:"get",params:this.$http.adornParams()}).then(function(e){var t=e.data;t&&0===t.code&&(a.priseimageUrl=n.a.imgUrl+t.data.licenseUrl,a.dataForm.businNumber=t.data.mchId,a.dataForm.companyName=t.data.companyName,a.dataForm.bussicAdress=t.data.address,a.dataForm.lawName=t.data.legalPerson,a.dataForm.businNum=t.data.licenseNo,a.dataForm.busindate1=t.data.effectDate,a.dataForm.busindate2=t.data.expireDate,a.dataForm.username=t.data.contactName,a.dataForm.mobile=t.data.mobile,a.dataForm.email=t.data.email,a.dataForm.work=t.data.position,a.dataForm.loginAcc=t.data.mobile,a.dataForm.agencylevel=t.data.levelId,a.dataForm.price=t.data.price,a.dataForm.allowCounts=t.data.emptyWarnNumber)}))},probusinNumber:function(){this.dataForm.businNumber=this.dataForm.businNumber.replace(/[^0-9]*/g,"").replace(/\b(0+)/gi,"")},dataFormSubmit:function(){var e=this;this.$refs.dataForm.validate(function(a){var t;a?e.$http({url:e.$http.adornUrl("agent/agentInfo/"+(e.dataForm.id?"update":"save")+"?token="+e.$cookie.get("token")),method:"post",params:e.$http.adornParams((t={agentId:e.dataForm.id||void 0,licensePicNo:e.licensePicNo,companyName:e.dataForm.companyName,mchId:e.dataForm.businNumber,address:e.dataForm.bussicAdress,email:e.dataForm.email,legalPerson:e.dataForm.lawName,licenseNo:e.dataForm.businNum,effectDate:e.dataForm.busindate1,expireDate:e.dataForm.busindate2,contactName:e.dataForm.username,position:e.dataForm.work,mobile:e.dataForm.mobile},o()(t,"email",e.dataForm.email),o()(t,"password",e.dataForm.pwd?i()(e.dataForm.pwd):""),o()(t,"levelId",e.dataForm.agencylevel),o()(t,"price",e.dataForm.price),o()(t,"emptyWarnNumber",e.dataForm.allowCounts),t))}).then(function(a){var t=a.data;t&&0===t.code?e.$message({message:"操作成功",type:"success",duration:1500,onClose:function(){e.visible=!1,e.$emit("refreshDataList")}}):e.$message.error(t.msg)}):e.$message.error("请完善信息!")})},clearAgent:function(){this.visible=!1,this.priseimageUrl="",this.dataForm.busindate1="",this.dataForm.busindate2=""},beforeAvatarUpload:function(e){var a="image/jpeg"===e.type||"image/png"==e.type||"image/jpg"==e.type,t=e.size/1024/1024<2;return a||this.$message.error("上传头像图片只能是 JPG 格式!"),t||this.$message.error("上传头像图片大小不能超过 2MB!"),a&&t},perisehandleAvatarSuccess:function(e,a){this.priseimageUrl=URL.createObjectURL(a.raw),this.licensePicNo=e.data.licensePicNo},closeDialog:function(e){e(),this.priseimageUrl="",this.dataForm.busindate1="",this.dataForm.busindate2="",this.dataForm.pwd=""},changeLevel:function(e){var a;a=this.agencylevelArr;for(var t=0;t<a.length;t++)a[t].id==e&&(this.dataForm.price=a[t].price,this.dataForm.allowCounts=a[t].emptyWarnNumber)}}},m={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("el-dialog",{attrs:{title:e.dataForm.id?"修改":"新增","close-on-click-modal":!1,visible:e.visible,"before-close":e.closeDialog},on:{"update:visible":function(a){e.visible=a}}},[t("el-form",{ref:"dataForm",staticClass:"demo-ruleForm",attrs:{model:e.dataForm,rules:e.datarules,"label-width":"150px","label-position":e.labelPosition}},[t("h3",[e._v("基本信息")]),e._v(" "),t("el-form-item",{attrs:{label:"营业执照：",prop:""}},[t("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.priseurl,accept:"image/jpeg,image/jpg,image/png","show-file-list":!1,"on-success":e.perisehandleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[e.priseimageUrl?t("img",{staticClass:"avatar",attrs:{src:e.priseimageUrl}}):t("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),e._v(" "),t("span",[e._v("（上传后，以下部分信息可自动导入）")])],1),e._v(" "),t("el-form-item",{attrs:{label:"商户编号：",prop:"businNumber"}},[t("el-input",{attrs:{placeholder:"商户编号",maxlength:"6"},nativeOn:{keyup:function(a){e.probusinNumber(a)}},model:{value:e.dataForm.businNumber,callback:function(a){e.$set(e.dataForm,"businNumber",a)},expression:"dataForm.businNumber"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"公司名称：",prop:"companyName"}},[t("el-input",{attrs:{placeholder:"公司名称"},model:{value:e.dataForm.companyName,callback:function(a){e.$set(e.dataForm,"companyName",a)},expression:"dataForm.companyName"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"营业执照所在地：",prop:"bussicAdress"}},[t("el-input",{attrs:{placeholder:"营业执照所在地"},model:{value:e.dataForm.bussicAdress,callback:function(a){e.$set(e.dataForm,"bussicAdress",a)},expression:"dataForm.bussicAdress"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"法人姓名：",prop:"lawName"}},[t("el-input",{attrs:{placeholder:"法人姓名"},model:{value:e.dataForm.lawName,callback:function(a){e.$set(e.dataForm,"lawName",a)},expression:"dataForm.lawName"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"营业执照号：",prop:"businNum"}},[t("el-input",{attrs:{placeholder:"营业执照号"},model:{value:e.dataForm.businNum,callback:function(a){e.$set(e.dataForm,"businNum",a)},expression:"dataForm.businNum"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"营业期限：",prop:"busindate1"}},[t("el-input",{staticStyle:{width:"35%"},attrs:{placeholder:"2018-08-18"},model:{value:e.dataForm.busindate1,callback:function(a){e.$set(e.dataForm,"busindate1",a)},expression:"dataForm.busindate1"}}),e._v("至\n            "),t("el-input",{staticStyle:{width:"35%"},attrs:{placeholder:"2020-12-25"},model:{value:e.dataForm.busindate2,callback:function(a){e.$set(e.dataForm,"busindate2",a)},expression:"dataForm.busindate2"}})],1),e._v(" "),t("h3",[e._v("联系人信息")]),e._v(" "),t("el-form-item",{attrs:{label:"联系人姓名：",prop:"username"}},[t("el-input",{attrs:{placeholder:"联系人姓名"},model:{value:e.dataForm.username,callback:function(a){e.$set(e.dataForm,"username",a)},expression:"dataForm.username"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"联系人手机号：",prop:"mobile"}},[t("el-input",{attrs:{placeholder:"联系人手机号",maxlength:"11",readonly:e.agentReadonly},model:{value:e.dataForm.mobile,callback:function(a){e.$set(e.dataForm,"mobile",a)},expression:"dataForm.mobile"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"联系人邮箱：",prop:"email"}},[t("el-input",{attrs:{placeholder:"联系人邮箱"},model:{value:e.dataForm.email,callback:function(a){e.$set(e.dataForm,"email",a)},expression:"dataForm.email"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"职务：",prop:"work"}},[t("el-input",{attrs:{placeholder:"职务"},model:{value:e.dataForm.work,callback:function(a){e.$set(e.dataForm,"work",a)},expression:"dataForm.work"}})],1),e._v(" "),t("h3",[e._v("账号信息")]),e._v(" "),t("el-form-item",{attrs:{label:"登录账号：",prop:"loginAcc"}},[t("el-input",{attrs:{placeholder:"登录账号",readonly:""},model:{value:e.dataForm.loginAcc,callback:function(a){e.$set(e.dataForm,"loginAcc",a)},expression:"dataForm.loginAcc"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"密码：",prop:e.dataForm.id?"":"pwd"}},[t("el-input",{attrs:{type:"password",placeholder:"密码"},model:{value:e.dataForm.pwd,callback:function(a){e.$set(e.dataForm,"pwd",a)},expression:"dataForm.pwd"}})],1),e._v(" "),t("h3",[e._v("代理商级别")]),e._v(" "),t("el-form-item",{attrs:{label:"代理级别：",prop:"agencylevel"}},[t("el-select",{attrs:{placeholder:"请选择代理级别"},on:{change:function(a){e.changeLevel(e.dataForm.agencylevel)}},model:{value:e.dataForm.agencylevel,callback:function(a){e.$set(e.dataForm,"agencylevel",a)},expression:"dataForm.agencylevel"}},e._l(e.agencylevelArr,function(e,a){return t("el-option",{key:a,attrs:{value:e.id,label:e.name}})}))],1),e._v(" "),t("el-form-item",{attrs:{label:"单价：",prop:"price"}},[t("el-input",{attrs:{placeholder:"单价"},model:{value:e.dataForm.price,callback:function(a){e.$set(e.dataForm,"price",a)},expression:"dataForm.price"}}),e._v(" "),t("span",[e._v("元/条")])],1),e._v(" "),t("el-form-item",{attrs:{label:"预警条数 ：",prop:"allowCounts"}},[t("el-input",{attrs:{placeholder:"空号预警条数 "},model:{value:e.dataForm.allowCounts,callback:function(a){e.$set(e.dataForm,"allowCounts",a)},expression:"dataForm.allowCounts"}}),e._v(" "),t("span",[e._v("条")])],1)],1),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(a){e.clearAgent()}}},[e._v("取消")]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:function(a){e.dataFormSubmit()}}},[e._v("确定")])],1)],1)},staticRenderFns:[]};var u=t("46Yf")(d,m,!1,function(e){t("QguD")},null,null);a.default=u.exports},"4Ayh":function(e,a,t){(e.exports=t("acE3")(!1)).push([e.i,"\n.avatar-uploader .el-upload {\n  border: 1px dashed #d9d9d9;\n  border-radius: 6px;\n  cursor: pointer;\n  position: relative;\n  overflow: hidden;\n}\n.avatar-uploader .el-upload:hover {\n  border-color: #409EFF;\n}\n.avatar-uploader-icon {\n  font-size: 28px;\n  color: #8c939d;\n  width: 100px;\n  height: 100px;\n  line-height: 100px;\n  text-align: center;\n}\n.avatar {\n  width: 100px;\n  height: 100px;\n  display: block;\n}\n#agentNumberCss .el-input__inner {\n  border: none;\n}\n",""])},QguD:function(e,a,t){var r=t("4Ayh");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);t("XkoO")("40d89248",r,!0)}});